(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{OZrI:function(t,e,i){"use strict";i.r(e),i.d(e,"kup_chart",function(){return c});var a,s,r=i("zp0o"),o=(i("fcjB"),i("fcTE"));function n(t,e){for(let i=0;i<e.length;i++){const a=e[i];if(t===a.name)return a}return null}!function(t){t.Area="Area",t.Bubble="Bubble",t.Cal="Cal",t.Candlestick="Candlestick",t.Combo="Combo",t.Geo="Geo",t.Hbar="Hbar",t.Line="Line",t.Ohlc="Ohlc",t.Pie="Pie",t.Sankey="Sankey",t.Scatter="Scatter",t.Unk="Unk",t.Vbar="Vbar"}(a||(a={})),function(t){t.D2="2D",t.D3="3D"}(s||(s={}));const h=(t,{series:e,axis:i})=>{if(!t||!e)return[];const a=[],s=n(i,t.columns);return s&&a.push(s),e.map(e=>{const i=n(e,t.columns);i&&a.push(i)}),a},l=(t,e,i)=>{if(!t)return[];const a=[];return t.rows&&t.rows.forEach(t=>{const s=t.cells,r=[];e.forEach((t,e)=>{const a=s[t.name];if(a&&a.obj){const t=i&&e>0;if(Object(o.m)(a.obj)){const e=function(t){return t.obj?Object(o.r)(t.obj.k).value():Object(o.r)(t.value).value()}(a);r.push(e),t&&r.push(e.toString())}else if(Object(o.e)(a.obj)){const e=function(t){let e="YYYYMMDD";if(t.obj){const i=t.obj;return"D8"===i.t&&"*DMYY"===i.p&&(e="DDMMYYYY"),Object(o.q)(t.obj.k,e)}return Object(o.q)(t.value,"DD/MM/YYYY")}(a).toDate();r.push(e),t&&r.push(e.toString())}else r.push(a.obj.k),t&&r.push(a.value)}}),a.push(r)}),a};class c{constructor(t){Object(r.g)(this,t),this.types=[a.Hbar],this.colors=[],this.legend=!0,this.stacked=!1,this.showMarks=!1,this.version="45.2",this.kupChartClicked=Object(r.d)(this,"kupChartClicked",6)}onDataChanged(){console.log("changing data")}componentDidLoad(){if(this.axis&&this.series&&google){document.querySelectorAll(`link[href^="https://www.gstatic.com/charts/${this.version}/css"]`).forEach(t=>this.el.shadowRoot.appendChild(t.cloneNode()));try{this.loadGoogleChart()}catch(t){console.error(t)}}}componentWillUpdate(){this.gChart&&this.gChart.clearChart()}componentDidUpdate(){this.loadGoogleChart()}loadGoogleChart(){google.charts.setOnLoadCallback(this.createChart.bind(this))}createGoogleChart(){if(this.isComboChart())return new google.visualization.ComboChart(this.chartContainer);if(1===this.types.length)switch(this.types[0]){case a.Area:return new google.visualization.AreaChart(this.chartContainer);case a.Bubble:return new google.visualization.BubbleChart(this.chartContainer);case a.Cal:return new google.visualization.Calendar(this.chartContainer);case a.Candlestick:return new google.visualization.CandlestickChart(this.chartContainer);case a.Geo:return new google.visualization.GeoChart(this.chartContainer);case a.Hbar:return new google.visualization.BarChart(this.chartContainer);case a.Line:return new google.visualization.LineChart(this.chartContainer);case a.Pie:return new google.visualization.PieChart(this.chartContainer);case a.Sankey:return new google.visualization.Sankey(this.chartContainer);case a.Scatter:return new google.visualization.ScatterChart(this.chartContainer);default:return new google.visualization.ColumnChart(this.chartContainer)}}getMainChartType(){return this.types.length>0?this.types[0]:a.Unk}isComboChart(){return this.types.length>1}createGoogleChartOptions(){const t={is3D:s.D3===this.asp};return this.colors&&this.colors.length>0&&(t.colors=this.colors),this.width&&(t.width=this.width),this.height&&(t.height=this.height),this.legend||(t.legend={position:"none"}),!this.stacked||a.Hbar!==this.getMainChartType()&&a.Vbar!==this.getMainChartType()||(t.isStacked=!0),this.graphTitle&&(t.title=this.graphTitle,t.titleTextStyle={},this.graphTitleColor&&(t.titleTextStyle.color=this.graphTitleColor),this.graphTitleSize&&(t.titleTextStyle.fontSize=this.graphTitleSize)),this.isComboChart()&&(t.series={},this.types.forEach((e,i)=>{let s="bars";a.Line===e?s="line":a.Area===e&&(s="area"),t.series[i.toString()]={type:s}})),t}createChart(){const t=h(this.data,{axis:this.axis,series:this.series}),e=l(this.data,t,this.showMarks),i=[];for(let s=0;s<t.length;s++)i.push({label:t[s].name}),s>0&&this.showMarks&&i.push({type:"string",role:"annotation"});this.gChartDataTable=new google.visualization.arrayToDataTable([i,...e]),this.gChartView=new google.visualization.DataView(this.gChartDataTable),this.gChart=this.createGoogleChart();const a=this.createGoogleChartOptions();this.gChart.draw(this.gChartView,a),google.visualization.events.addListener(this.gChart,"select",this.onChartSelect.bind(this))}onChartSelect(){const t=this.gChart.getSelection()[0];if(t){const e={};if(t.date){if(e.datetime=t.date,!t.row&&0!=t.row)return;{const i=this.gChartView.getTableRowIndex(t.row);e.row=this.data.rows[i]}}else{const i=t.row,a=t.column,s=this.gChartView.getTableRowIndex(null!=i?i:0);if(e.row=this.data.rows[s],this.series.length>1){let t=this.gChartView.getTableColumnIndex(null!=a?a:0);"annotation"===this.gChartDataTable.getColumnProperty(t,"role")&&--t,e.column=Object(o.k)(this.data.columns,this.series[t-1])}else e.column=Object(o.k)(this.data.columns,this.series[0])}this.kupChartClicked.emit(e)}}render(){return Object(r.f)("div",{id:"chart",ref:t=>this.chartContainer=t})}get el(){return Object(r.e)(this)}static get watchers(){return{data:["onDataChanged"]}}}}}]);