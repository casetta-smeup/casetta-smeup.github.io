const t=window.mycomponent.h;class e{constructor(){this.config={},this.globalFilter="",this.currentPage=1}getColumns(){return this.data&&this.data.data&&this.data.data.columns?this.data.data.columns:[{title:""}]}getRows(){return this.data&&this.data.data&&this.data.data.rows?this.data.data.rows:[]}get filters(){return this.config&&this.config.filter?this.config.filter:{}}set filters(t){this.config=this.config?Object.assign({},this.config,{filter:t}):{showFilter:!0,filter:t}}get sort(){return this.config&&this.config.sort?this.config.sort:[]}set sort(t){this.config=this.config?Object.assign({},this.config,{sort:t}):{sort:t}}getFilteredRows(){if(this.filters&&Object.keys(this.filters).length>0||this.globalFilter){const t=Object.keys(this.filters);return this.getRows().filter(e=>{if(this.globalFilter){let t=!1;for(let i=0;i<this.data.data.columns.length;i++)if(e.cells[this.data.data.columns[i].name].value.toLowerCase().includes(this.globalFilter.toLocaleLowerCase())){t=!0;break}if(!t)return!1}return t.filter(t=>{const i=this.filters[t],n=e.cells[t];return!(!n||!n.value)&&(!!n.value.toLowerCase().includes(i.toLowerCase())||void 0)}).length===t.length})}return this.getRows()}showFilters(){return this.config&&this.config.showFilter}showSort(){return!this.config||!this.config.hasOwnProperty("enableSort")||this.config.enableSort}onColumnSort(t){const e=t.target.dataset.col;let i=0;for(;i<this.sort.length&&this.sort[i].column!==e;i++);if(i<this.sort.length){const t=this.sort[i],e=Object.assign({},t,{sortMode:"A"===t.sortMode?"D":"A"}),n=[...this.sort];n[i]=e,this.sort=n}else{const i={column:e,sortMode:"A"};this.sort=t.ctrlKey?[...this.sort,i]:[i]}}onFilterChange(t){const e=t.target.dataset.col,i=Object.assign({},this.filters);0===t.detail.value.length?delete i[e]:i[e]=t.detail.value,this.filters=i}onGlobalFilterChange(t){this.globalFilter=t.detail.value}sortRows(t){if(0===this.sort.length)return t;const e=this.sort.length>1;return t.sort((t,i)=>{if(e){for(let e=0;e<this.sort.length;e++){const n=this.sort[e],s=t.cells[n.column].value,a=i.cells[n.column].value;if(s!==a)return("A"===n.sortMode?1:-1)*s.localeCompare(a)}return 0}{const e=this.sort[0];return("A"===e.sortMode?1:-1)*t.cells[e.column].value.localeCompare(i.cells[e.column].value)}})}get rowsPerPage(){return this.config&&this.config.rowsPerPage?this.config.rowsPerPage:10}paginateRows(t){const e=this.currentPage*this.rowsPerPage-this.rowsPerPage;return t.slice(e,e+this.rowsPerPage)}getSortIcon(t){for(let e=0;e<this.sort.length;e++){const i=this.sort[e];if(i.column===t)return"A"===i.sortMode?"mdi-sort-ascending":"mdi-sort-descending"}return"mdi-sort"}handlePageChanged({detail:t}){this.currentPage=t.newPage}renderHeader(){return this.getColumns().map(e=>{let i=null;if(this.showFilters()){let n="";this.filters&&this.filters[e.name]&&(n=this.filters[e.name]),i=t("div",null,t("kup-text-input",{initialValue:n,"data-col":e.name,onKetchupTextInputUpdated:t=>{this.onFilterChange(t)}}))}let n=null;return this.showSort()&&(n=t("span",{class:"column-sort"},t("icon",{class:"mdi "+this.getSortIcon(e.name),"data-col":e.name,onClick:t=>this.onColumnSort(t)}))),t("th",null,t("span",{class:"column-title"},e.title),n,i)})}render(){const e=this.renderHeader(),i=this.getFilteredRows(),n=this.sortRows(i),s=this.paginateRows(n);let a=null;a=0===s.length?t("tr",null,t("td",{colSpan:this.getColumns().length},"Empty data")):s.map(e=>{const i=this.getColumns().map(({name:i})=>t("td",null,e.cells[i].value));return t("tr",null,i)});const r=t("kup-paginator",{max:this.getRows().length,perPage:this.rowsPerPage,onKupPageChanged:t=>this.handlePageChanged(t)});let l=null;return this.config&&this.config.globalFilter&&(l=t("div",{id:"globalFilter"},t("kup-text-input",{label:"Global filter",onKetchupTextInputUpdated:t=>this.onGlobalFilterChange(t)}))),t("div",null,r,l,t("table",null,t("thead",null,t("tr",null,e)),t("tbody",null,a)))}static get is(){return"kup-data-table"}static get encapsulation(){return"shadow"}static get properties(){return{config:{type:"Any",attr:"config",mutable:!0},currentPage:{state:!0},data:{type:"Any",attr:"data"},globalFilter:{state:!0}}}static get style(){return"\@import url(https://cdn.materialdesignicons.com/3.6.95/css/materialdesignicons.min.css);table.sc-kup-data-table{width:100%;border-collapse:collapse}table.sc-kup-data-table, table.sc-kup-data-table   td.sc-kup-data-table, table.sc-kup-data-table   th.sc-kup-data-table{border:1px solid #000}table.sc-kup-data-table   td.sc-kup-data-table, table.sc-kup-data-table   th.sc-kup-data-table{padding:.5rem}table.sc-kup-data-table   .column-sort.sc-kup-data-table{margin-left:.5rem;cursor:pointer}table.sc-kup-data-table   th.sc-kup-data-table   input.sc-kup-data-table{display:block}#globalFilter.sc-kup-data-table{margin-bottom:.5rem;text-align:center}"}}class i{constructor(){this.max=0,this.perPage=10,this.currentPage=1}isPrevPageDisabled(){return 1==this.currentPage}isNextPageDisabled(){return this.currentPage*this.perPage>=this.max}onPrevPage(){this.isPrevPageDisabled()||(this.currentPage=this.currentPage-1,this.kupPageChanged.emit({newPage:this.currentPage}))}onNextPage(){this.isNextPageDisabled()||(this.currentPage=this.currentPage+1,this.kupPageChanged.emit({newPage:this.currentPage}))}onGoToPage({target:t}){this.currentPage=parseInt(t.value),this.kupPageChanged.emit({newPage:this.currentPage})}render(){let e="mdi mdi-chevron-left";this.isPrevPageDisabled()&&(e+=" disabled");let i="mdi mdi-chevron-right";this.isNextPageDisabled()&&(i+=" disabled");const n=[],s=Math.ceil(this.max/this.perPage);n.push(t("option",{value:"1",selected:1===this.currentPage},"1"));for(let e=2;e<=s;e++)n.push(t("option",{value:e,selected:this.currentPage===e},e));return t("div",{id:"paginator"},t("span",{class:"label"},"Pagina"),t("span",{class:"prev-page"},t("icon",{className:e,onclick:()=>this.onPrevPage()})),t("select",{onChange:t=>this.onGoToPage(t)},n),t("span",{class:"next-page"},t("icon",{className:i,onclick:()=>this.onNextPage()})),t("span",{class:"label"},"Di ",s))}static get is(){return"kup-paginator"}static get encapsulation(){return"shadow"}static get properties(){return{currentPage:{state:!0},max:{type:Number,attr:"max"},perPage:{type:Number,attr:"per-page"}}}static get events(){return[{name:"kupPageChanged",method:"kupPageChanged",bubbles:!0,cancelable:!1,composed:!0}]}static get style(){return"\@import url(https://cdn.materialdesignicons.com/3.6.95/css/materialdesignicons.min.css);#paginator.sc-kup-paginator{display:-ms-flexbox;display:flex;margin-bottom:.5rem}#paginator.sc-kup-paginator   icon.sc-kup-paginator{cursor:pointer}#paginator.sc-kup-paginator   icon.disabled.sc-kup-paginator{cursor:default;opacity:.3}"}}var n=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a="object"==typeof s&&s&&s.Object===Object&&s,r="object"==typeof self&&self&&self.Object===Object&&self,l=a||r||Function("return this")(),o=l,u=function(){return o.Date.now()},c=l.Symbol,h=Object.prototype,g=h.hasOwnProperty,d=h.toString,p=c?c.toStringTag:void 0,f=Object.prototype.toString,b=c?c.toStringTag:void 0,m=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?function(t){var e=g.call(t,p),i=t[p];try{t[p]=void 0;var n=!0}catch(t){}var s=d.call(t);return n&&(e?t[p]=i:delete t[p]),s}(t):function(t){return f.call(t)}(t)},v=/^\s+|\s+$/g,P=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,x=/^0o[0-7]+$/i,y=parseInt,C=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==m(t)}(t))return NaN;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(v,"");var i=w.test(t);return i||x.test(t)?y(t.slice(2),i?2:8):P.test(t)?NaN:+t},k=Math.max,I=Math.min,T=function(t,e,i){var s,a,r,l,o,c,h=0,g=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=s,n=a;return s=a=void 0,h=e,l=t.apply(n,i)}function b(t){var i=t-c;return void 0===c||i>=e||i<0||d&&t-h>=r}function m(){var t=u();if(b(t))return v(t);o=setTimeout(m,function(t){var i=e-(t-c);return d?I(i,r-(t-h)):i}(t))}function v(t){return o=void 0,p&&s?f(t):(s=a=void 0,l)}function P(){var t=u(),i=b(t);if(s=arguments,a=this,c=t,i){if(void 0===o)return function(t){return h=t,o=setTimeout(m,e),g?f(t):l}(c);if(d)return o=setTimeout(m,e),f(c)}return void 0===o&&(o=setTimeout(m,e)),l}return e=C(e)||0,n(i)&&(g=!!i.leading,r=(d="maxWait"in i)?k(C(i.maxWait)||0,e):r,p="trailing"in i?!!i.trailing:p),P.cancel=function(){void 0!==o&&clearTimeout(o),h=0,s=c=a=o=void 0},P.flush=function(){return void 0===o?l:v(u())},P};class F{constructor(){this.initialValue="",this.isClearable=!1,this.label="",this.maxLength=524288,this.debounce=400,this.value="",this.classInputText="ketchup-input-text"}debounceChanged(){this.ketchupTextInputUpdated=function(t,e){const i=t._original||t;return{_original:t,emit:T(i.emit.bind(i),e)}}(this.ketchupTextInputUpdated,this.debounce)}componentWillLoad(){this.value=this.initialValue}componentDidLoad(){this.debounceChanged()}triggerFocus(){this.inputEl.focus(),this.textInput.focus()}onClearClick(){this.value="",setTimeout(()=>this.triggerFocus(),10)}onKeyDown(t){"Enter"===t.key&&(t.preventDefault(),this.ketchupTextInputSubmit.emit({value:this.value}))}onInputBlurred(t){const{target:e}=t;this.inputBlur.emit({value:e.value,oldValue:this.value}),this.value=e.value}onInputFocused(t){const{target:e}=t;this.inputFocused.emit({value:e.value,oldValue:this.value}),this.value=e.value}onInputUpdated(t){const{target:e}=t;this.ketchupTextInputUpdated.emit({value:e.value,oldValue:this.value}),this.value=e.value}render(){const e=this.classInputText+"__container";let i=null;return this.label&&(i=t("label",{htmlFor:"ketchup-input"},this.label)),t("div",{class:e+(this.isClearable?" "+e+"--clearable":"")},i,t("input",{id:"ketchup-input",class:this.classInputText+(this.isClearable?" "+this.classInputText+"--clearable":""),maxlength:this.maxLength,ref:t=>this.textInput=t,tabindex:"0",value:this.value,onBlur:this.onInputBlurred.bind(this),onInput:this.onInputUpdated.bind(this),onFocus:this.onInputFocused.bind(this),onKeyDown:this.onKeyDown.bind(this)}),this.isClearable?t("button",{"aria-label":"Close",class:this.classInputText+"__clear",role:"button",onClick:this.onClearClick.bind(this)},t("svg",{viewBox:"0 0 24 24"},t("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}))):null)}static get is(){return"kup-text-input"}static get encapsulation(){return"shadow"}static get properties(){return{debounce:{type:Number,attr:"debounce",watchCallbacks:["debounceChanged"]},initialValue:{type:String,attr:"initial-value"},inputEl:{elementRef:!0},isClearable:{type:Boolean,attr:"is-clearable"},label:{type:String,attr:"label"},maxLength:{type:Number,attr:"max-length"},triggerFocus:{method:!0},value:{state:!0}}}static get events(){return[{name:"ketchupTextInputBlurred",method:"inputBlur",bubbles:!0,cancelable:!1,composed:!0},{name:"ketchupTextInputFocused",method:"inputFocused",bubbles:!0,cancelable:!1,composed:!0},{name:"ketchupTextInputSubmit",method:"ketchupTextInputSubmit",bubbles:!0,cancelable:!1,composed:!0},{name:"ketchupTextInputUpdated",method:"ketchupTextInputUpdated",bubbles:!0,cancelable:!1,composed:!0}]}static get style(){return".sc-kup-text-input-h{--int_font-size:var(--kup-text-input_font-size,14px);--int_border-color:var(--kup-text-input_border-color,grey);--int_border-color--selected:var(--kup-text-input_border-color--selected,#4e908f);--int_tr-duration:var(--kup-text-input_transition-duration,0.6s);--int_icon-color:var(--kup-text-input_icon-color,grey);--int_icon-color--hover:var(--kup-text-input_icon-color--hover,#676767);display:inline-block}label.sc-kup-text-input{margin-right:.5rem}.ketchup-input-text.sc-kup-text-input{background-color:#fff;border:1px solid var(--int_border-color);border-radius:2px;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;padding:4px 6px;position:relative;-webkit-transition:background-color var(--int_tr-duration);transition:background-color var(--int_tr-duration);z-index:0}.ketchup-input-text__container.sc-kup-text-input{display:inline-block;position:relative;z-index:0}.ketchup-input-text.sc-kup-text-input:focus, .ketchup-input-text.sc-kup-text-input:hover{border-color:var(--int_border-color--selected)}.ketchup-input-text--clearable.sc-kup-text-input{padding-right:calc(6px + 4px * 2 + var(--int_font-size))}.ketchup-input-text__clear.sc-kup-text-input{-ms-flex-align:center;align-items:center;background-color:transparent;border:none;cursor:pointer;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-pack:center;justify-content:center;margin:0;outline:none;padding:4px;position:absolute;right:6px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);z-index:1}.ketchup-input-text__clear.sc-kup-text-input > svg.sc-kup-text-input{fill:var(--int_icon-color);height:var(--int_font-size);-webkit-transition:fill var(--int_tr-duration);transition:fill var(--int_tr-duration);width:var(--int_font-size)}.ketchup-input-text__clear.sc-kup-text-input:hover > svg.sc-kup-text-input{fill:var(--int_icon-color--hover)}"}}export{e as KupDataTable,i as KupPaginator,F as KupTextInput};